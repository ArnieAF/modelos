<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modelos Mental y Conceptual - App Delivery</title>
    <script src="https://gojs.net/latest/release/go.js"></script>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>Modelos Mental y Conceptual - App Delivery</h1>
            <p class="subtitle">Visualizando la diferencia entre la percepción del usuario y la complejidad del sistema</p>
        </header>
            <div class="diagram-section">
                <div id="diagram-container"></div>
                <div class="controls">
                    <button id="toggleButton">Ver Modelo Conceptual del Sistema</button>
                    <div class="legend">
                        <div class="legend-item">
                            <div class="color-box user-color"></div>
                            <span>Modelo Mental del Usuario</span>
                        </div>
                        <div class="legend-item">
                            <div class="color-box system-color"></div>
                            <span>Modelo Conceptual del Sistema</span>
                        </div>
                    </div>
                </div>
            </div>        
        <footer>
            <p>Adriano Flores Arnie Jeampool</p>
        </footer>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const $ = go.GraphObject.make;
            let diagram = $(go.Diagram, "diagram-container", {
                layout: $(go.TreeLayout, {
                    angle: 90,
                    nodeSpacing: 50,
                    layerSpacing: 80
                }),
                "undoManager.isEnabled": true
            });

            // Plantilla de nodos
            diagram.nodeTemplate =
                $(go.Node, "Auto",
                    { 
                        toolTip: $(go.Adornment, "Auto", 
                            $(go.Shape, { fill: "#202020" }),
                            $(go.TextBlock, { margin: 5, stroke: "white" }, 
                            new go.Binding("text", "tooltip")))
                    },
                    $(go.Shape, "RoundedRectangle", {
                        strokeWidth: 2,
                        stroke: null,
                        portId: ""
                    }, new go.Binding("fill", "color")),
                    $(go.TextBlock, {
                        margin: 10,
                        stroke: "#ffffff",
                        font: "14px sans-serif",
                        wrap: go.TextBlock.WrapFit,
                        textAlign: "center"
                    }, new go.Binding("text", "text"))
                );

            // Plantilla de enlaces
            diagram.linkTemplate =
                $(go.Link,
                    { routing: go.Link.Orthogonal, corner: 10 },
                    $(go.Shape, { strokeWidth: 2, stroke: "#777" }),
                    $(go.Shape, { toArrow: "Standard", fill: "#777", stroke: null })
                );

            // Modelo Mental del Usuario (Delivery)
            const userMentalModel = {
                nodes: [
                    { key: "open", text: "Abrir la App", color: "#4CAF50", tooltip: "El usuario simplemente abre la aplicación." },
                    { key: "search", text: "Buscar Restaurante", color: "#4CAF50", tooltip: "Busca un restaurante que le guste." },
                    { key: "choose", text: "Elegir Comida", color: "#4CAF50", tooltip: "Selecciona los platos que desea ordenar." },
                    { key: "pay", text: "Pagar", color: "#4CAF50", tooltip: "Realiza el pago de su pedido." },
                    { key: "wait", text: "Esperar Comida", color: "#4CAF50", tooltip: "Espera a que llegue su pedido." }
                ],
                links: [
                    { from: "open", to: "search" },
                    { from: "search", to: "choose" },
                    { from: "choose", to: "pay" },
                    { from: "pay", to: "wait" }
                ]
            };

            // Modelo Conceptual del Sistema (Delivery)
            const systemConceptualModel = {
                nodes: [
                    { key: "auth", text: "Autenticación", color: "#F44336", tooltip: "Verificación de credenciales del usuario." },
                    { key: "geo", text: "Geolocalización", color: "#F44336", tooltip: "Determina la ubicación para mostrar restaurantes cercanos." },
                    { key: "db_query", text: "Consulta BD Menús", color: "#F44336", tooltip: "Consulta la base de datos para mostrar menús disponibles." },
                    { key: "cart", text: "Gestión Carrito", color: "#F44336", tooltip: "Gestiona los items en el carrito de compras." },
                    { key: "payment", text: "Integración Pago", color: "#F44336", tooltip: "Se conecta con servicio de pago para procesar transacción." },
                    { key: "send_order", text: "Envío Orden", color: "#F44336", tooltip: "Envía la orden al restaurante seleccionado." },
                    { key: "assign", text: "Asignar Repartidor", color: "#F44336", tooltip: "Asigna un repartidor para la entrega." },
                    { key: "tracking", text: "Seguimiento Tiempo Real", color: "#F44336", tooltip: "Permite seguir el pedido en tiempo real." },
                    { key: "notifications", text: "Envío Notificaciones", color: "#F44336", tooltip: "Envía notificaciones sobre el estado del pedido." },
                    { key: "delivery", text: "Proceso Entrega", color: "#F44336", tooltip: "Gestiona el proceso de entrega y confirmación." }
                ],
                links: [
                    { from: "auth", to: "geo" },
                    { from: "geo", to: "db_query" },
                    { from: "db_query", to: "cart" },
                    { from: "cart", to: "payment" },
                    { from: "payment", to: "send_order" },
                    { from: "send_order", to: "assign" },
                    { from: "assign", to: "tracking" },
                    { from: "tracking", to: "notifications" },
                    { from: "notifications", to: "delivery" }
                ]
            };

            // Función para alternar entre modelos
            let isUserView = true;
            const toggleButton = document.getElementById("toggleButton");

            const updateDiagram = () => {
                diagram.model = new go.GraphLinksModel(
                    isUserView ? userMentalModel.nodes : systemConceptualModel.nodes,
                    isUserView ? userMentalModel.links : systemConceptualModel.links
                );
                diagram.centerRect(diagram.documentBounds);
            };

            // Establecer modelo inicial
            updateDiagram();

            // Evento de clic al botón
            toggleButton.addEventListener('click', () => {
                isUserView = !isUserView;
                updateDiagram();
                toggleButton.textContent = isUserView ? "Ver Modelo Conceptual del Sistema" : "Ver Modelo Mental del Usuario";
            });
        });
    </script>
</body>
</html>
